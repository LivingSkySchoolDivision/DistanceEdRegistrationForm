@page "{Id=0}"
@using LSSD.DistanceEdReg
@using LSSD.DistanceEdReg.Data
@using LSSD.DistanceEdReg.Util
@model LSSDDistanceEdReg.WebFrontEnd.Pages.RegisterModel
@{
    ViewData["Title"] = "Register";
    Layout = "~/Pages/Shared/_Layout.cshtml";

    // Create a list of courses to use later
    DistanceEdClassRepository classesRepo = new DistanceEdClassRepository();
    List<DistanceEdClass> availableClasses = classesRepo.GetAvailableClasses(DateTime.Now);

    string courseIdString = RouteData.Values["Id"].ToString();
    int courseIdParsed = courseIdString.ToInt();

    if (courseIdParsed > 0)
    {
        availableClasses = availableClasses.Where(x => x.ID == courseIdParsed).ToList();
    }
}

<h1>Register a student</h1>
<p>
    Once submitted, this form is processed by Division Office staff.<br />
    You will receive an email when the registration has been complete.<br />
    Registration may take several business days to complete.
</p>
<form method="post" asp-page-handler="Search" style="display: inline;">
    <table border="0" cellpadding="5" cellspacing="5">
        <tr>
            <td valign="top"><b>Student Name</b></td>
            <td valign="top"><input name="txtStudentName" class="form-control" type="text" style="width: 500px;" placeholder="John Smith" required></td>
        </tr>
        <tr>
            <td valign="top"><b>Student Number</b></td>
            <td valign="top"><input name="txtStudentNumber" class="form-control" type="text" style="width: 500px;" placeholder="123456789" required></td>
        </tr>
        <tr>
            <td valign="top"><b>Student School</b></td>
            <td valign="top"><input name="txtStudentSchool" class="form-control" type="text" style="width: 500px;" placeholder="Miskatonic High School" required></td>
        </tr>
        <tr>
            <td valign="top"><b>Course</b></td>
            <td valign="top">
                <div style="padding: 10px; padding-top: 0;">
                    <!-- courses go here -->
                    @foreach (DistanceEdClass c in availableClasses.OrderBy(x => x.Name))
                    {
                    <div class="form-check">
                        @if (courseIdParsed > 0)
                        {
                            <input name="chkClass_@c.ID" class="form-check-input" type="checkbox" checked/>
                        }
                        else
                        {
                            <input name="chkClass_@c.ID" class="form-check-input" type="checkbox" />
                        }
                        <label for="chkClass_@c.ID" class="form-check-label">
                            <b>@c.Name</b>
                            @if (!string.IsNullOrEmpty(c.MoreInfoURL))
                            {
                                <div style="display: inline; font-size: 90%;">(<a href="@c.MoreInfoURL">More info</a>)</div>
                            }
                        </label>
                        @if (!string.IsNullOrEmpty(c.Description))
                        {
                            <div style="font-size: 75%;">
                                @c.Description
                            </div>
                        }
                        @if (c.MentorTeacherRequired)
                        {
                            <div style="font-size: 75%;">
                                <label for="txtMentor_@c.ID"><b>Mentor Teacher Name</b></label>
                                <input name="txtMentor_@c.ID" type="text" class="form-control form-control-sm" style="width: 300px;" />
                            </div>
                        }
                    </div>
                        <br />
                    }
                </div>
            </td>
        </tr>
        <tr>
            <td valign="top"><b>Additional Notes</b></td>
            <td valign="top"><textarea name="txtNotes" class="form-control"></textarea></td>
        </tr>
        <tr>
            <td cospan="2" align="center" valign="top">
                <button class="btn btn-primary small" style="margin-left: 10px;">Submit Registration</button>
            </td>
        </tr>
    </table>
</form>

